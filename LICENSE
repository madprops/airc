You can use and modify this code.